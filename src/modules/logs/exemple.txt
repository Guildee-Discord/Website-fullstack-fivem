ğŸ“ configuration/webhook.json

{
  "webhooks": {
    "url": {
      "logs":  "https://discord.com/api/webhooks/ID/TOKEN",
      "login": "https://discord.com/api/webhooks/ID/TOKEN",
      "admin": "https://discord.com/api/webhooks/ID/TOKEN"
    },
    "custom": {
      "logs": {
        "username": "Website Logs",
        "avatar_url": "https://i.imgur.com/1J5qX5E.png"
      },
      "login": {
        "username": "Login",
        "avatar_url": "https://i.imgur.com/abcd1234.png"
      },
      "admin": {
        "username": "Admin",
        "avatar_url": "https://i.imgur.com/efgh5678.png"
      }
    }
  }
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”§ AccÃ¨s aux valeurs

- webhooks.url.<nom>               â†’ URL du webhook
- webhooks.custom.<nom>.username   â†’ Nom affichÃ© du webhook
- webhooks.custom.<nom>.avatar_url â†’ Avatar du webhook

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ§  Initialisation dans createContainer(config)

ctx.webhooks = null;

ctx.webhooksReady = new Promise(resolve => {
  ctx._resolveWebhooksReady = resolve;
});

â†’ Une fois les webhooks chargÃ©s :
ctx._resolveWebhooksReady();

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â³ Utilisation dans tous les modules

Toujours commencer par :
await ctx.webhooksReady;

VÃ©rifier la disponibilitÃ© :

if (!ctx.webhooks?.login?.send) {
  ctx.logger?.warn?.("[login] webhook non prÃªt");
  return;
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ‰ï¸ Envoyer un message simple

try {
  await ctx.webhooks.login.send({
    content: "âœ… Module Login dÃ©marrÃ©"
  });
} catch (e) {
  ctx.logger?.warn?.("[login] webhook error: " + (e.message || String(e)));
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“¦ Envoyer un log embed

try {
  await ctx.webhooks.login.log({
    level: "success",
    title: "Module Login",
    message: "DÃ©marrÃ© correctement",
    fields: [
      { name: "Serveur", value: "prod-1", inline: true },
      { name: "Port", value: "3000", inline: true }
    ]
  });
} catch (e) {
  ctx.logger?.warn?.("[login] webhook log error: " + (e.message || String(e)));
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â• Ajouter un nouveau webhook

Dans configuration/webhook.json :

- webhooks.url.staff
- webhooks.custom.staff

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ§ª Test rapide

await ctx.webhooksReady;

try {
  await ctx.webhooks?.logs?.send?.({
    content: "Hello webhook ğŸ‘‹"
  });
} catch (e) {
  ctx.logger?.warn?.("Webhook error: " + (e.message || String(e)));
}